cmake_minimum_required(VERSION 3.28)
project(nrlib)

list(APPEND nrlib_HEADERS
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsecarfin.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsecarfingroup.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipseeditnnc.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsefaceindexer.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsefault.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsegeometry.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsegrid.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsetools.hpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsetransmult.hpp
${CMAKE_CURRENT_LIST_DIR}/exception/exception.hpp
${CMAKE_CURRENT_LIST_DIR}/fft/fft.hpp
${CMAKE_CURRENT_LIST_DIR}/fft/fftgrid2d.hpp
${CMAKE_CURRENT_LIST_DIR}/fft/fftgrid3d.hpp
${CMAKE_CURRENT_LIST_DIR}/flens/nrlib_flens.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/bilinearsurface.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/box.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/interpolation.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/line.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/plane.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/point.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/polygon.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/transformation.hpp
${CMAKE_CURRENT_LIST_DIR}/geometry/triangle.hpp
${CMAKE_CURRENT_LIST_DIR}/grid/grid.hpp
${CMAKE_CURRENT_LIST_DIR}/grid/grid2d.hpp
${CMAKE_CURRENT_LIST_DIR}/grid/grid2dgeneral.hpp
${CMAKE_CURRENT_LIST_DIR}/grid/grid4d.hpp
${CMAKE_CURRENT_LIST_DIR}/grid/grid5d.hpp
${CMAKE_CURRENT_LIST_DIR}/iotools/bigfile.hpp
${CMAKE_CURRENT_LIST_DIR}/iotools/fileio.hpp
${CMAKE_CURRENT_LIST_DIR}/iotools/logkit.hpp
${CMAKE_CURRENT_LIST_DIR}/iotools/logstream.hpp
${CMAKE_CURRENT_LIST_DIR}/iotools/serialize.hpp
${CMAKE_CURRENT_LIST_DIR}/iotools/stringtools.hpp
${CMAKE_CURRENT_LIST_DIR}/iotools/tabularfile.hpp
${CMAKE_CURRENT_LIST_DIR}/math/constants.hpp
${CMAKE_CURRENT_LIST_DIR}/math/mathutility.hpp
${CMAKE_CURRENT_LIST_DIR}/pointset/pointset.hpp
${CMAKE_CURRENT_LIST_DIR}/random/beta.hpp
${CMAKE_CURRENT_LIST_DIR}/random/betawithendmass.hpp
${CMAKE_CURRENT_LIST_DIR}/random/binomial.hpp
${CMAKE_CURRENT_LIST_DIR}/random/chisquared.hpp
${CMAKE_CURRENT_LIST_DIR}/random/delta.hpp
${CMAKE_CURRENT_LIST_DIR}/random/distribution.hpp
${CMAKE_CURRENT_LIST_DIR}/random/fractal.hpp
${CMAKE_CURRENT_LIST_DIR}/random/functions.hpp
${CMAKE_CURRENT_LIST_DIR}/random/gamma.hpp
${CMAKE_CURRENT_LIST_DIR}/random/generaldiscrete.hpp
${CMAKE_CURRENT_LIST_DIR}/random/lognormal.hpp
${CMAKE_CURRENT_LIST_DIR}/random/normal.hpp
${CMAKE_CURRENT_LIST_DIR}/random/poisson.hpp
${CMAKE_CURRENT_LIST_DIR}/random/random.hpp
${CMAKE_CURRENT_LIST_DIR}/random/randomgenerator.hpp
${CMAKE_CURRENT_LIST_DIR}/random/splituniform.hpp
${CMAKE_CURRENT_LIST_DIR}/random/triangular.hpp
${CMAKE_CURRENT_LIST_DIR}/random/uniform.hpp
${CMAKE_CURRENT_LIST_DIR}/statistics/continuouskrigingdata2d.hpp
${CMAKE_CURRENT_LIST_DIR}/statistics/kriging.hpp
${CMAKE_CURRENT_LIST_DIR}/statistics/krigingdata2d.hpp
${CMAKE_CURRENT_LIST_DIR}/statistics/multinormal.hpp
${CMAKE_CURRENT_LIST_DIR}/statistics/nodalkrigingdata2d.hpp
${CMAKE_CURRENT_LIST_DIR}/statistics/posteriormultinormal.hpp
${CMAKE_CURRENT_LIST_DIR}/statistics/statistics.hpp
${CMAKE_CURRENT_LIST_DIR}/stormgrid/stormcontgrid.hpp
${CMAKE_CURRENT_LIST_DIR}/stormgrid/stormfaciesgrid.hpp
${CMAKE_CURRENT_LIST_DIR}/surface/regularsurface.hpp
${CMAKE_CURRENT_LIST_DIR}/surface/regularsurfacerotated.hpp
${CMAKE_CURRENT_LIST_DIR}/surface/surface.hpp
${CMAKE_CURRENT_LIST_DIR}/surface/surfaceio.hpp
${CMAKE_CURRENT_LIST_DIR}/trend/trend.hpp
${CMAKE_CURRENT_LIST_DIR}/trend/trendkit.hpp
${CMAKE_CURRENT_LIST_DIR}/trend/trendstorage.hpp
${CMAKE_CURRENT_LIST_DIR}/variogram/covgrid2d.hpp
${CMAKE_CURRENT_LIST_DIR}/variogram/fftcovgrid.hpp
${CMAKE_CURRENT_LIST_DIR}/variogram/gaussianfield.hpp
${CMAKE_CURRENT_LIST_DIR}/variogram/variogram.hpp
${CMAKE_CURRENT_LIST_DIR}/variogram/variogramtypes.hpp
${CMAKE_CURRENT_LIST_DIR}/volume/volume.hpp
${CMAKE_CURRENT_LIST_DIR}/wavelet/wavelet.hpp
${CMAKE_CURRENT_LIST_DIR}/wavelet/waveletio.hpp
${CMAKE_CURRENT_LIST_DIR}/well/laswell.hpp
${CMAKE_CURRENT_LIST_DIR}/well/norsarwell.hpp
${CMAKE_CURRENT_LIST_DIR}/well/rmswell.hpp
${CMAKE_CURRENT_LIST_DIR}/well/well.hpp
${CMAKE_CURRENT_LIST_DIR}/well/welloperations.hpp)

list(APPEND nrlib_SOURCES
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsecarfin.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsecarfingroup.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipseeditnnc.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsefaceindexer.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsefault.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsegeometry.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsegrid.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsetools.cpp
${CMAKE_CURRENT_LIST_DIR}/eclipsegrid/eclipsetransmult.cpp
${CMAKE_CURRENT_LIST_DIR}/fft/fft.cpp
${CMAKE_CURRENT_LIST_DIR}/fft/fftgrid2d.cpp
${CMAKE_CURRENT_LIST_DIR}/fft/fftgrid3d.cpp
${CMAKE_CURRENT_LIST_DIR}/flens/nrlib_flens.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/bilinearsurface.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/box.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/interpolation.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/line.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/plane.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/point.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/polygon.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/transformation.cpp
${CMAKE_CURRENT_LIST_DIR}/geometry/triangle.cpp
${CMAKE_CURRENT_LIST_DIR}/iotools/bigfile.cpp
${CMAKE_CURRENT_LIST_DIR}/iotools/fileio.cpp
${CMAKE_CURRENT_LIST_DIR}/iotools/logkit.cpp
${CMAKE_CURRENT_LIST_DIR}/iotools/logstream.cpp
${CMAKE_CURRENT_LIST_DIR}/iotools/serialize.cpp
${CMAKE_CURRENT_LIST_DIR}/iotools/stringtools.cpp
${CMAKE_CURRENT_LIST_DIR}/iotools/tabularfile.cpp
${CMAKE_CURRENT_LIST_DIR}/math/constants.cpp
${CMAKE_CURRENT_LIST_DIR}/pointset/pointset.cpp
${CMAKE_CURRENT_LIST_DIR}/random/beta.cpp
${CMAKE_CURRENT_LIST_DIR}/random/betawithendmass.cpp
${CMAKE_CURRENT_LIST_DIR}/random/binomial.cpp
${CMAKE_CURRENT_LIST_DIR}/random/chisquared.cpp
${CMAKE_CURRENT_LIST_DIR}/random/delta.cpp
${CMAKE_CURRENT_LIST_DIR}/random/dSFMT.cpp
${CMAKE_CURRENT_LIST_DIR}/random/fractal.cpp
${CMAKE_CURRENT_LIST_DIR}/random/functions.cpp
${CMAKE_CURRENT_LIST_DIR}/random/gamma.cpp
${CMAKE_CURRENT_LIST_DIR}/random/generaldiscrete.cpp
${CMAKE_CURRENT_LIST_DIR}/random/lognormal.cpp
${CMAKE_CURRENT_LIST_DIR}/random/normal.cpp
${CMAKE_CURRENT_LIST_DIR}/random/poisson.cpp
${CMAKE_CURRENT_LIST_DIR}/random/random.cpp
${CMAKE_CURRENT_LIST_DIR}/random/randomgenerator.cpp
${CMAKE_CURRENT_LIST_DIR}/random/splituniform.cpp
${CMAKE_CURRENT_LIST_DIR}/random/triangular.cpp
${CMAKE_CURRENT_LIST_DIR}/random/uniform.cpp
${CMAKE_CURRENT_LIST_DIR}/statistics/continuouskrigingdata2d.cpp
${CMAKE_CURRENT_LIST_DIR}/statistics/kriging.cpp
${CMAKE_CURRENT_LIST_DIR}/statistics/multinormal.cpp
${CMAKE_CURRENT_LIST_DIR}/statistics/nodalkrigingdata2d.cpp
${CMAKE_CURRENT_LIST_DIR}/statistics/posteriormultinormal.cpp
${CMAKE_CURRENT_LIST_DIR}/stormgrid/stormcontgrid.cpp
${CMAKE_CURRENT_LIST_DIR}/stormgrid/stormfaciesgrid.cpp
${CMAKE_CURRENT_LIST_DIR}/surface/surfaceio.cpp
${CMAKE_CURRENT_LIST_DIR}/tinyxml/tinyxml.cpp
${CMAKE_CURRENT_LIST_DIR}/tinyxml/tinyxmlerror.cpp
${CMAKE_CURRENT_LIST_DIR}/tinyxml/tinyxmlparser.cpp
${CMAKE_CURRENT_LIST_DIR}/trend/trend.cpp
${CMAKE_CURRENT_LIST_DIR}/trend/trendkit.cpp
${CMAKE_CURRENT_LIST_DIR}/trend/trendstorage.cpp
${CMAKE_CURRENT_LIST_DIR}/variogram/covgrid2d.cpp
${CMAKE_CURRENT_LIST_DIR}/variogram/fftcovgrid.cpp
${CMAKE_CURRENT_LIST_DIR}/variogram/gaussianfield.cpp
${CMAKE_CURRENT_LIST_DIR}/variogram/variogram.cpp
${CMAKE_CURRENT_LIST_DIR}/variogram/variogramtypes.cpp
${CMAKE_CURRENT_LIST_DIR}/volume/volume.cpp
${CMAKE_CURRENT_LIST_DIR}/wavelet/wavelet.cpp
${CMAKE_CURRENT_LIST_DIR}/wavelet/waveletio.cpp
${CMAKE_CURRENT_LIST_DIR}/well/laswell.cpp
${CMAKE_CURRENT_LIST_DIR}/well/norsarwell.cpp
${CMAKE_CURRENT_LIST_DIR}/well/rmswell.cpp
${CMAKE_CURRENT_LIST_DIR}/well/well.cpp)

set(BOOST_ROOT "/usr/local/Homebrew/Cellar/boost@1.76/1.76.0_4")
set(Boost_LIBRARY_DIR "${BOOST_ROOT}/lib")
set(Boost_USE_STATIC_LIBS ON)
find_package(Boost 1.76 EXACT REQUIRED COMPONENTS unit_test_framework)
include_directories(${Boost_INCLUDE_DIRS})

set(FFTW_INCLUDE_DIR "/usr/local/Homebrew/Cellar/fftw/3.3.10_1/include")
set(FFTW_DOUBLE_LIB "/usr/local/Homebrew/Cellar/fftw/3.3.10_1/lib/libfftw3.a")
set(FFTW_SINGLE_LIB "/usr/local/Homebrew/Cellar/fftw/3.3.10_1/lib/libfftw3f.a")
include_directories(${FFTW_INCLUDE_DIR})

if (APPLE)
include_directories("/opt/homebrew/opt/openblas/include")
endif (APPLE)

# Assuming nrlib should be compiled as a static library
add_library(nrlib STATIC ${nrlib_SOURCES})

target_include_directories(nrlib PUBLIC
${CMAKE_CURRENT_SOURCE_DIR}  # for nrlib's own headers
${CMAKE_CURRENT_SOURCE_DIR}/..  # for the flens headers
)

add_executable(nrlib_tests
variogram/unittests/test.cpp
variogram/unittests/fftcovgrid_test.cpp
variogram/unittests/gaussianfield_test.cpp)

target_link_libraries(nrlib ${FFTW_LIBRARIES} ${FFTW_DOUBLE_LIB} ${FFTW_SINGLE_LIB})

target_link_libraries(nrlib_tests ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY} nrlib)

target_include_directories(nrlib_tests PRIVATE ${CMAKE_CURRENT_SOURCE_DIR})
