services:
  build-linux:
    image: quay.io/pypa/manylinux2014_x86_64
    environment:
      PYTHON:
    volumes:
      # Sharing the entire volume causes the created venv to be broken on the host
      - "./.git:/code/.git"  # Used to get the version while building (setuptools_scm)
      - "./Makefile:/code/Makefile"
      - "./bin:/code/bin"
      - "./cmake:/code/cmake"
      - "./src:/code/src"
      - "./sources:/code/sources"
      - "./gaussianfft:/code/gaussianfft"

      - "./LICENSE.txt:/code/LICENSE.txt"
      - "./README.md:/code/README.md"
      - "./CMakeLists.txt:/code/CMakeLists.txt"
      - "./pyproject.toml:/code/pyproject.toml"
      - "./utils.py:/code/utils.py"

      # The build artifacts are stored in these locations
      - "./dist:/code/dist"  # The result from python -m build
      - "./wheelhouse:/code/wheelhouse"  # The result from python -m auditwheel
    entrypoint: ["make", "-C", "/code", "build"]
